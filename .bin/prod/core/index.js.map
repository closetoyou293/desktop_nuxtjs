{"version":3,"sources":["../../../server/core/index.js"],"names":["Nuxt","Express","Socket","Mongo","Core","constructor","Config","require","path","resolve","Log","Msg","lang","App","Init","HTTP","http","createServer","IO","DB","APIs","Routes","Sockets","Models","Run","Show","MongoConect","BuildModel","BuildAPI","BuildIO","nuxt","use","render","HTTPStart","global","Server","e","Error","listen","process","env","PORT","port","server","start","NODE_ENV","then","ipv4"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;AAGA;;IAAYA,I;;AACZ;;IAAYC,O;;AACZ;;IAAYC,M;;AACZ;;IAAYC,K;;AAGZ;;;;;;;;AAEe,MAAMC,IAAN,CAAW;AACtBC,kBAAa;AACT,aAAKC,MAAL,GAAcC,QAAQC,eAAKC,OAAL,CAAa,iBAAb,CAAR,CAAd;AACA,aAAKC,GAAL,GAAW,IAAIA,aAAJ,EAAX;AACA,aAAKC,GAAL,GAAWJ,QAAQC,eAAKC,OAAL,CAAc,UAAS,KAAKH,MAAL,CAAYM,IAAK,EAAxC,CAAR,CAAX;AACA,aAAKC,GAAL,GAAWZ,QAAQa,IAAR,CAAa,KAAKR,MAAlB,CAAX;AACA,aAAKS,IAAL,GAAYC,eAAKC,YAAL,CAAkB,KAAKJ,GAAvB,CAAZ;AACA,aAAKK,EAAL,GAAUhB,OAAOY,IAAP,CAAY,KAAKC,IAAjB,CAAV;;AAGA,aAAKI,EAAL,GAAU,IAAV;AACA;AACA,aAAKC,IAAL,GAAY,EAAZ;AACA,aAAKC,MAAL,GAAc,EAAd;AACA,aAAKC,OAAL,GAAe,EAAf;AACA,aAAKC,MAAL,GAAc,EAAd;AACH;AACD,UAAMC,GAAN,GAAW;AACP,aAAKd,GAAL,CAASe,IAAT,CAAc,4BAAd;AACA,YAAI;AACA,gBAAIC,cAAc,MAAMvB,MAAMW,IAAN,CAAW,IAAX,CAAxB;AACA,gBAAIa,aAAa,MAAMxB,MAAMwB,UAAN,CAAiB,KAAKJ,MAAtB,EAA8B,IAA9B,CAAvB;AACA,gBAAIK,WAAW,MAAM3B,QAAQ2B,QAAR,CAAiB,KAAKR,IAAtB,EAA4B,IAA5B,CAArB;AACA,gBAAIS,UAAU,MAAM3B,OAAO2B,OAAP,CAAe,KAAKP,OAApB,EAA6B,IAA7B,CAApB;;AAEA,gBAAIQ,OAAO,MAAM9B,KAAKc,IAAL,EAAjB;AACA,iBAAKD,GAAL,CAASkB,GAAT,CAAaD,KAAKE,MAAlB;AACA,iBAAKb,EAAL,GAAUQ,UAAV;;AAEA,iBAAKM,SAAL;AACAC,mBAAOC,MAAP,GAAgB,IAAhB;AACH,SAZD,CAaA,OAAMC,CAAN,EAAQ;AACJ,iBAAK1B,GAAL,CAAS2B,KAAT,CAAeD,CAAf;AACA,iBAAK1B,GAAL,CAASe,IAAT,CAAc,6BAAd;AACH;AACJ;AACDQ,gBAAW;AACP,aAAKvB,GAAL,CAASe,IAAT,CAAc,6BAAd;AACA,aAAKV,IAAL,CAAUuB,MAAV,CAAiBC,QAAQC,GAAR,CAAYC,IAAZ,IAAoB,KAAKnC,MAAL,CAAYoC,IAAjD;;AAEA,aAAKhC,GAAL,CAASe,IAAT,CAAe,GAAE,KAAKd,GAAL,CAASgC,MAAT,CAAgBC,KAAM,EAAvC;;AAEA,YAAG,EAAEL,QAAQC,GAAR,CAAYK,QAAZ,KAAyB,YAA3B,CAAH,EAA4C;AACxC,gBAAG,KAAKvC,MAAL,CAAYoC,IAAZ,KAAqB,IAAxB,EAA8B,OAAO,KAAKhC,GAAL,CAASe,IAAT,CAAe,oBAAmB,KAAKnB,MAAL,CAAYoC,IAAK,EAAnD,CAAP;AAC9B,8CAAmBI,IAAnB,CAAyBC,IAAD,IAAU;AAC9B,qBAAKrC,GAAL,CAASe,IAAT,CAAe,UAASsB,IAAK,EAA7B;AACH,aAFD;AAGH;AACJ;AAjDqB;kBAAL3C,I;;AAHrB;;;AANA","file":"index.js","sourcesContent":["import path from 'path';\r\nimport http from 'http';\r\nimport localIpV4Address from 'local-ipv4-address';\r\n\r\n//Init\r\nimport * as Nuxt from './nuxt_init';\r\nimport * as Express from './express_init';\r\nimport * as Socket from './socket_init';\r\nimport * as Mongo from './mongodb_init';\r\n\r\n//lib\r\nimport Log from '../lib/log';\r\n\r\nexport default class Core {\r\n    constructor(){\r\n        this.Config = require(path.resolve('./app.config.js'));\r\n        this.Log = new Log();\r\n        this.Msg = require(path.resolve(`./lang/${this.Config.lang}`));\r\n        this.App = Express.Init(this.Config);\r\n        this.HTTP = http.createServer(this.App);\r\n        this.IO = Socket.Init(this.HTTP);\r\n\r\n        \r\n        this.DB = null;\r\n        //List\r\n        this.APIs = [];\r\n        this.Routes = [];\r\n        this.Sockets = [];\r\n        this.Models = [];\r\n    }\r\n    async Run(){\r\n        this.Log.Show('----------Build-----------')\r\n        try {\r\n            let MongoConect = await Mongo.Init(this);\r\n            let BuildModel = await Mongo.BuildModel(this.Models, this);\r\n            let BuildAPI = await Express.BuildAPI(this.APIs, this);\r\n            let BuildIO = await Socket.BuildIO(this.Sockets, this);\r\n\r\n            let nuxt = await Nuxt.Init();\r\n            this.App.use(nuxt.render);\r\n            this.DB = BuildModel\r\n\r\n            this.HTTPStart();\r\n            global.Server = this;\r\n        }\r\n        catch(e){\r\n            this.Log.Error(e);\r\n            this.Log.Show('--------Build Done---------')\r\n        }\r\n    }\r\n    HTTPStart(){\r\n        this.Log.Show('--------Build Done---------')\r\n        this.HTTP.listen(process.env.PORT || this.Config.port);\r\n\r\n        this.Log.Show(`${this.Msg.server.start}`);\r\n        \r\n        if(!(process.env.NODE_ENV === 'production')){\r\n            if(this.Config.port !== '80') return this.Log.Show(`http://localhost:${this.Config.port}`);\r\n            localIpV4Address().then((ipv4) => {\r\n                this.Log.Show(`http://${ipv4}`);\r\n            });\r\n        }\r\n    }\r\n}"]}